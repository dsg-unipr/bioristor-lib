use nalgebra::{SMatrix, SVector};

use crate::algorithms::Algorithm;
use crate::losses::Loss;
use crate::models::{EquationModel, Model};
use crate::params::Variables;

/// Implementation of the Neural Network algorithm for the equation model.
///
/// # Type parameters
///
/// * `M` - The type of the model.
/// * `L` - The loss function to be used.
/// * `TOPOLOGY` - The topology of the neural network:
///     - `0`: 1 hidden layer with 16 neurons,
///     - `1`: 2 hidden layer with 64 and 32 neurons respectively.
pub struct NeuralNetworkEquation<M: Model, L: Loss, const TOPOLOGY: usize> {
    /// The model to be solved.
    model: M,

    // Mean and std for input/output standardization
    input_mean: SVector<f32, 4>,
    input_std: SVector<f32, 4>,
    output_mean: SVector<f32, 3>,
    output_std: SVector<f32, 3>,

    _t: core::marker::PhantomData<L>,
}

impl<M, L> Algorithm<(), M> for NeuralNetworkEquation<M, L, 0>
where
    M: EquationModel,
    L: Loss<ModelOutput = f32>,
{
    /// Create a new instance of the Neural Network algorithm.
    ///
    /// # Arguments
    ///
    /// * `params` - The parameters of the algorithm.
    /// * `model` - The model to be solved by the algorithm.
    fn new(_: (), model: M) -> Self {
        Self {
            model,
            input_mean: SVector::<f32, 4>::new(-0.002274, -0.002545, 1.241e-06, 38.94),
            input_std: SVector::<f32, 4>::new(0.001004, 0.001047, 5.142e-07, 15.5),
            output_mean: SVector::<f32, 3>::new(0.01102, 21.13, 0.5935),
            output_std: SVector::<f32, 3>::new(0.01253, 25.15, 0.2052),
            _t: core::marker::PhantomData,
        }
    }

    /// Tries to solve the model for the given parameters using the Neural
    /// Network algorithm and returns the best solution found.
    ///
    /// # Returns
    ///
    /// * `Some((vars, loss))` - The variables and the loss of the solution.
    /// * `None` - If the algorithm could not find a solution.
    fn run(&self) -> Option<(Variables, f32)> {
        let mut x = SVector::<f32, 4>::new(
            self.model.currents().i_ds_on,
            self.model.currents().i_ds_off,
            self.model.currents().i_gs_on,
            self.model.params().r_dry,
        );
        let mut y: SVector<f32, 3>;

        // Input standardization
        x = (x - self.input_mean).component_div(&self.input_std);

        // First linear layer
        let weight = SMatrix::<f32, 16, 4>::from_row_slice(&models::L16_WEIGHT_0);
        let bias = SVector::<f32, 16>::from_row_slice(&models::L16_BIAS_0);
        let mut x = weight * x + bias;

        // Activation function: ReLU
        x.apply(|x| {
            if *x < 0.0 {
                *x = 0.0;
            }
        });

        // Second linear layer
        let weight = SMatrix::<f32, 3, 16>::from_row_slice(&models::L16_WEIGHT_1);
        let bias = SVector::<f32, 3>::from_row_slice(&models::L16_BIAS_1);
        y = weight * x + bias;

        // Output de-standardization
        y = y.component_mul(&self.output_std) + self.output_mean;

        Some((
            Variables {
                concentration: y[0],
                resistance: y[1],
                saturation: y[2],
            },
            L::evaluate(self.model.value(y[0])),
        ))
    }
}

impl<M, L> Algorithm<(), M> for NeuralNetworkEquation<M, L, 1>
where
    M: EquationModel,
    L: Loss<ModelOutput = f32>,
{
    /// Create a new instance of the Neural Network algorithm.
    ///
    /// # Arguments
    ///
    /// * `params` - The parameters of the algorithm.
    /// * `model` - The model to be solved by the algorithm.
    fn new(_: (), model: M) -> Self {
        Self {
            model,
            input_mean: SVector::<f32, 4>::new(-0.002274, -0.002545, 1.241e-06, 38.94),
            input_std: SVector::<f32, 4>::new(0.001004, 0.001047, 5.142e-07, 15.5),
            output_mean: SVector::<f32, 3>::new(0.01102, 21.13, 0.5935),
            output_std: SVector::<f32, 3>::new(0.01253, 25.15, 0.2052),
            _t: core::marker::PhantomData,
        }
    }

    /// Tries to solve the model for the given parameters using the Neural
    /// Network algorithm and returns the best solution found.
    ///
    /// # Returns
    ///
    /// * `Some((vars, loss))` - The variables and the loss of the solution.
    /// * `None` - If the algorithm could not find a solution.
    fn run(&self) -> Option<(Variables, f32)> {
        let mut x = SVector::<f32, 4>::new(
            self.model.currents().i_ds_on,
            self.model.currents().i_ds_off,
            self.model.currents().i_gs_on,
            self.model.params().r_dry,
        );
        let mut y: SVector<f32, 3>;

        // Input standardization
        x = (x - self.input_mean).component_div(&self.input_std);

        // First linear layer
        let weight = SMatrix::<f32, 64, 4>::from_row_slice(&models::L64_32_WEIGHT_0);
        let bias = SVector::<f32, 64>::from_row_slice(&models::L64_32_BIAS_0);
        let mut x = weight * x + bias;

        // Activation function: ReLU
        x.apply(|x| {
            if *x < 0.0 {
                *x = 0.0;
            }
        });

        // Second linear layer
        let weight = SMatrix::<f32, 32, 64>::from_row_slice(&models::L64_32_WEIGHT_1);
        let bias = SVector::<f32, 32>::from_row_slice(&models::L64_32_BIAS_1);
        let mut x = weight * x + bias;

        // Activation function: ReLU
        x.apply(|x| {
            if *x < 0.0 {
                *x = 0.0;
            }
        });

        // Third linear layer
        let weight = SMatrix::<f32, 3, 32>::from_row_slice(&models::L64_32_WEIGHT_2);
        let bias = SVector::<f32, 3>::from_row_slice(&models::L64_32_BIAS_2);
        y = weight * x + bias;

        // Output de-standardization
        y = y.component_mul(&self.output_std) + self.output_mean;

        Some((
            Variables {
                concentration: y[0],
                resistance: y[1],
                saturation: y[2],
            },
            L::evaluate(self.model.value(y[0])),
        ))
    }
}

#[allow(clippy::excessive_precision)]
mod models {
    #[rustfmt::skip]
    pub const L16_WEIGHT_0: [f32; 4 * 16] = [
         2.972057580948e+00, -1.381307363510e+00,  9.842012077570e-03, -3.302331864834e-01,
        -1.474937796593e+00,  7.212218046188e-01,  1.442872136831e-01,  6.649064421654e-01,
        -8.732492923737e-01,  1.448835253716e+00, -2.108419388533e-01, -8.035251498222e-01,
         1.348159790039e+00, -1.940223932266e+00, -2.055133730173e-01,  2.346971817315e-02,
        -5.187535285950e+00,  6.848367691040e+00,  1.702580899000e-01, -9.963951706886e-01,
        -1.580709338188e+00,  1.784294247627e+00,  3.463390097022e-02,  7.114356160164e-01,
         1.496533602476e-01,  6.219395995140e-01,  1.220334023237e-01,  4.175146818161e-01,
         1.614096045494e+00, -2.104583024979e+00, -4.750037193298e-01,  3.489318788052e-01,
        -4.499691128731e-01,  3.870156705379e-01,  2.439353317022e-01, -9.587871432304e-01,
        -1.299375295639e+00,  7.919045686722e-01,  3.736510127783e-02,  2.974621057510e-01,
        -2.055848598480e+00,  2.709375143051e+00,  7.510381937027e-02, -1.111545324326e+00,
         1.485884904861e+00, -1.726985216141e+00,  5.161756183952e-03,  5.013876557350e-01,
        -1.029920101166e+00,  6.004672646523e-01,  1.748999804258e-01,  8.778454065323e-01,
        -5.595550537109e+00,  6.532163619995e+00,  1.306919902563e-01, -5.327695012093e-01,
         1.005698204041e+00, -8.023644089699e-01, -3.574615716934e-01, -1.078765630722e+00,
        -2.846948146820e+00,  4.040512084961e+00,  2.936931326985e-03, -2.522709369659e-01,
    ];
    #[rustfmt::skip]
    pub const L16_BIAS_0: [f32; 16] = [
        -1.598485589027, -0.027418790385,  0.262458711863,  0.463451176882,
        -2.725843191147,  0.562609553337, -1.819449305534,  1.523669481277,
        -1.138132810593,  0.647483408451, -0.854796111584,  0.619469523430,
         0.014335671440, -1.633760452271, -0.195840626955, -1.494579911232,
    ];

    #[rustfmt::skip]
    pub const L16_WEIGHT_1: [f32; 16 * 3] = [
        -1.638158321381, -0.698880136013,  0.451962977648,
         1.329954981804,  3.570479631424,  0.239240363240,
        -1.278849124908, -1.186394453049,  1.179645299911,
        -0.055110894144,  1.407536029816, -0.088992394507,
         0.797154426575,  5.740182876587, -0.738796651363,
         1.989595293999,  1.369312763214,  0.825203299522,
         0.142862722278, -0.238756865263,  6.079715251923,
         0.256988495588, -0.233829602599,  0.015381777659,
         0.229472666979, -0.807580649853,  0.612869560719,
         0.555524766445, -0.891857624054,  0.881193339825,
         0.128303185105,  1.687536001205,  1.479473471642,
         0.509085476398, -0.947641789913, -1.148369550705,
        -0.393966495991, -1.121113181114,  0.192241385579,
         0.609675765038, -0.096853062510, -0.553103089333,
        -1.471911668777,  1.169251561165,  0.110921926796,
        -0.641528069973,  0.235405072570, -1.879667520523,
    ];
    pub const L16_BIAS_1: [f32; 3] = [0.765792191029, -0.266673147678, 0.317421406507];

    #[rustfmt::skip]
    pub const L64_32_WEIGHT_0: [f32; 4 * 64] = [
        -1.072191596031e+00,  1.679111957550e+00,  6.803459674120e-02, -5.546972155571e-01,
        -6.310040354729e-01,  2.340331673622e-01, -2.705764956772e-02,  4.423460662365e-01,
        -9.018294513226e-02,  2.669241130352e-01, -4.337597489357e-01, -1.623701602221e-01,
        -5.201207995415e-01, -4.527591168880e-01, -1.761323213577e-01,  3.170557618141e-01,
        -7.713327407837e-01,  1.698505520821e+00, -1.024351418018e-01, -2.432948499918e-01,
        -1.149332165718e+00,  1.591055512428e+00, -5.525942891836e-02,  3.466970026493e-01,
        -2.594819366932e-01,  1.991768181324e-01,  5.846743583679e-01, -3.165189027786e-01,
         3.839989304543e-01, -1.129439711571e+00, -4.210918247700e-01,  5.596953034401e-01,
        -2.948322594166e-01, -1.171178929508e-02, -2.053320705891e-01, -5.276736021042e-01,
        -8.957901597023e-01,  1.209048748016e+00,  2.653662264347e-01,  2.243203818798e-01,
         6.949570775032e-02, -2.359388619661e-01,  8.853360265493e-02, -6.000580191612e-01,
        -3.684425354004e-01, -2.319493293762e-01,  8.838257752359e-03,  4.088015258312e-01,
         3.742667287588e-02, -8.689045906067e-01,  1.878425180912e-01,  3.708049058914e-01,
         7.122098207474e-01, -3.500410020351e-01,  7.547984272242e-02, -2.599487602711e-01,
         9.639634191990e-02, -3.800657987595e-01, -2.538897991180e-01, -3.245716691017e-01,
        -1.744239358231e-03,  5.925185680389e-01, -1.451913267374e-01, -2.224463410676e-02,
         2.744860053062e-01, -6.310868263245e-02,  1.909077167511e-02,  1.158523559570e-01,
        -8.892815113068e-01,  1.495585680008e+00, -1.966221332550e-01, -5.664529651403e-02,
        -1.208072066307e+00,  2.203501462936e+00,  1.591771095991e-01, -2.194866165519e-02,
        -3.543275874108e-03, -5.443745851517e-01,  6.931489706039e-02, -3.827962279320e-01,
        -4.424910545349e+00,  4.526792526245e+00,  1.242625191808e-01, -7.401964068413e-01,
         6.711409240961e-02, -1.265096813440e-01, -7.564968615770e-02, -3.332500159740e-01,
         4.254350364208e-01, -7.208303213120e-01,  9.744148701429e-02,  4.972525238991e-01,
         5.502229332924e-01, -7.763000577688e-02, -1.240906193852e-01, -1.983298659325e-01,
         1.324662923813e+00, -9.607633948326e-01, -6.033004820347e-02, -5.538147315383e-02,
        -5.596882700920e-01,  1.734679341316e+00,  2.805233746767e-02, -3.805224299431e-01,
        -4.485246539116e-01, -2.855226211250e-02, -2.856369614601e-01, -6.537342667580e-01,
         2.052904844284e+00, -2.309225082397e+00, -4.136352241039e-01,  3.269718289375e-01,
        -3.479662656784e+00,  3.956577301025e+00,  1.946125924587e-01, -7.997018694878e-01,
         1.423133611679e+00, -1.764807820320e+00,  1.264622956514e-01,  1.764118671417e-01,
         1.488775968552e+00, -1.097465872765e+00, -1.388376671821e-02,  1.452005207539e-01,
        -4.563327431679e-01, -2.070613354445e-01, -7.683134172112e-03, -2.872387766838e-01,
        -1.610841602087e-01, -5.430602431297e-01,  6.278929859400e-02,  3.554280102253e-01,
        -2.787013649940e-01, -4.675846081227e-03,  4.523536562920e-01,  4.877623915672e-02,
        -2.480841800570e-02, -1.192852705717e-01,  3.083835542202e-01,  5.225830078125e-01,
         6.229045987129e-01, -7.511038333178e-02,  2.516326308250e-01, -2.033850550652e-01,
        -4.170735180378e-01, -2.145963311195e-01,  2.741344273090e-01,  1.724221855402e-01,
        -2.646310627460e-01, -4.259001910686e-01, -2.907968461514e-01, -6.878451108932e-01,
        -1.632683753967e+00,  2.049755096436e+00,  8.421056717634e-02, -9.214928150177e-01,
         3.161814212799e-01, -4.904227554798e-01, -9.541127830744e-02, -4.214675128460e-01,
         4.998508691788e-01, -5.562601685524e-01, -7.605217397213e-02, -1.877500675619e-02,
        -1.048960685730e-01, -6.485017389059e-02, -2.365491390228e-01,  2.742913663387e-01,
        -4.691687524319e-01, -5.642343685031e-02,  7.033783197403e-01, -9.596749395132e-02,
         1.378420710564e+00, -5.678045749664e-01, -3.023999631405e-01,  5.111174285412e-02,
        -1.145301107317e-02, -1.137527227402e-01,  2.859680652618e-01, -7.171505689621e-01,
         7.966254353523e-01, -6.344863176346e-01,  4.035978913307e-01,  3.830653801560e-02,
        -6.842976808548e-01,  1.563232898712e+00, -7.293540984392e-02, -2.124847769737e-01,
        -1.952404141426e+00,  2.166857242584e+00, -7.112575229257e-03,  3.373968303204e-01,
        -2.416603714228e-01,  3.236123546958e-02, -5.319617390633e-01, -1.774457395077e-01,
        -4.831034541130e-01, -1.433888915926e-02, -2.749640345573e-01,  2.243155427277e-02,
        -1.520247936249e+00,  2.008427619934e+00, -1.867765635252e-01, -3.020043671131e-01,
        -2.394114494324e+00,  2.723975896835e+00, -4.446852579713e-02,  1.039005368948e-01,
         1.894510388374e+00, -1.711263298988e+00,  1.038040816784e-01, -4.343872144818e-02,
         6.852609664202e-02, -2.240194082260e-01,  5.381103605032e-03,  1.061010211706e-01,
        -3.062799572945e-01, -2.070358544588e-01,  2.487729042768e-01, -8.054239153862e-01,
        -3.296053886414e+00,  4.320169448853e+00,  1.629363559186e-02, -2.607410848141e-01,
        -1.372173428535e+00,  1.509178161621e+00, -1.660853624344e-01, -6.391740590334e-02,
        -1.007720604539e-01, -9.158262610435e-02, -1.672356948256e-02,  6.265374422073e-01,
        -2.613364934921e+00,  3.310558795929e+00,  2.666447758675e-01, -9.512990117073e-01,
         4.389447212219e+00, -5.093025207520e+00, -4.083920121193e-01,  5.445282459259e-01,
        -1.661941051483e+00,  2.605038881302e+00, -1.098226383328e-01, -1.092935204506e-01,
         1.587138414383e+00, -1.884061217308e+00,  8.143045902252e-01, -6.729613542557e-01,
         7.741727828979e-01, -9.436027407646e-01, -2.668658494949e-01,  1.690433621407e-01,
         3.856314659119e+00, -3.286314010620e+00,  1.536626964808e-01,  1.775686815381e-02,
    ];
    #[rustfmt::skip]
    pub const L64_32_BIAS_0: [f32; 64] = [
        -0.972021877766,  0.697976708412, -0.399916946888, -0.495268255472,
        -1.148192882538, -0.323041498661,  0.255554080009,  1.015506148338,
        -0.005514008459, -0.141488522291, -0.201847523451,  0.307820022106,
         1.179880857468, -0.283658683300, -0.385632663965, -0.622975289822,
        -0.472734510899, -0.760605216026, -1.126174449921, -0.633541762829,
        -0.106021456420, -0.300886034966,  0.221393138170, -0.395377784967,
        -0.202813476324, -1.423886060715, -0.607176840305,  0.740024507046,
        -0.699393451214,  0.769055306911, -0.248455211520,  0.235853254795,
        -0.113388516009,  0.046732842922, -0.110030427575, -0.584097445011,
         0.286933451891, -0.086354933679, -0.936995029449, -0.340582728386,
         0.234979391098, -0.376209169626,  0.279029667377, -0.782019436359,
        -0.377669811249,  0.160171017051, -1.066309809685, -0.044034078717,
         0.087598025799, -0.380129218102, -0.544126570225, -0.351599067450,
         0.124508716166, -0.082544974983, -0.570222973824, -1.367458343506,
        -0.176264151931, -0.150814563036, -0.807317733765,  1.610944628716,
        -1.180448055267,  0.672329485416,  0.429777204990, -0.141465187073,
    ];

    #[rustfmt::skip]
    pub const L64_32_WEIGHT_1: [f32; 64 * 32] = [
        -9.924453683197e-03, -8.039040118456e-02, -8.641332387924e-02,  6.490157684311e-04,  1.455315202475e-01,  5.410751700401e-02,
         1.208174601197e-01, -7.533683627844e-02, -3.394611552358e-02,  1.215717289597e-02, -9.711769223213e-02, -1.595467701554e-02,
         1.305042952299e-01,  6.205710396171e-02, -8.150877058506e-02,  2.658606693149e-02,  9.439595043659e-02,  2.104095183313e-02,
         1.402540057898e-01,  1.472982913256e-01,  9.929327666759e-02, -4.137307032943e-02,  1.155979111791e-01, -1.324396952987e-02,
        -1.339722722769e-01,  2.205110341311e-01,  1.603299006820e-02, -1.496203057468e-02,  6.106115505099e-02,  5.150397494435e-02,
        -1.857333118096e-03,  1.376862078905e-01,  4.090799763799e-02,  1.087294146419e-01,  1.746456138790e-02,  5.092128738761e-02,
        -3.128595184535e-03,  6.414005160332e-02, -2.604365162551e-02,  3.681083023548e-02, -1.664453595877e-01, -1.312959939241e-01,
        -4.707122966647e-02,  7.417639344931e-02,  1.192916110158e-01,  2.151974439621e-01,  1.911588907242e-01, -7.476338744164e-02,
        -9.298934042454e-02, -4.825681820512e-02, -1.804475188255e-01,  6.882967054844e-02, -9.177324920893e-02, -6.308831274509e-02,
        -1.304727643728e-01, -8.850798755884e-02, -4.491375293583e-03,  1.695422083139e-01,  1.966494917870e-01, -3.480845317245e-02,
         1.534194946289e-01, -1.165986508131e-01,  1.891820318997e-02,  1.679408363998e-03,
        -3.244280070066e-02, -2.842283248901e-02,  5.805096030235e-02,  4.627374932170e-02, -1.424229592085e-01, -1.698297075927e-02,
         1.469659954309e-01, -7.895120978355e-02, -8.868157118559e-02, -4.035252705216e-02, -2.121410332620e-02, -8.985801599920e-03,
        -2.458292804658e-02, -6.092677358538e-03, -8.196054399014e-02, -2.976553514600e-03,  7.993611693382e-02, -1.533351391554e-01,
        -1.915427148342e-01,  1.392851173878e-01,  1.017931178212e-01, -9.689008444548e-02,  1.295440047979e-01,  7.224028557539e-02,
        -7.132118195295e-02, -4.070262610912e-02, -1.441472023726e-01, -1.946729607880e-02,  6.648150086403e-02,  9.655169211328e-03,
        -2.990183234215e-02, -8.906976878643e-02,  2.530054189265e-02,  1.429073885083e-02, -5.683092400432e-03,  4.880598187447e-02,
        -6.955481320620e-02, -8.675327897072e-02,  1.066446602345e-01,  4.900022223592e-02,  6.535084545612e-02, -9.360613673925e-02,
         3.590099513531e-02, -1.336230039597e-01,  3.888749331236e-02,  1.408000141382e-01, -1.510484665632e-01,  4.575666785240e-02,
         8.599191159010e-02, -5.631964281201e-02, -1.481665372849e-01, -1.064492315054e-01,  4.570604860783e-02, -8.557929098606e-02,
         3.659172728658e-02, -3.055110573769e-01, -1.850309967995e-01, -8.474002778530e-02,  3.337943926454e-02,  7.205200940371e-02,
        -2.542363703251e-01,  2.963984310627e-01, -2.446227334440e-02, -1.609715074301e-02,
         2.872646450996e-01, -4.023117125034e-01,  1.182515174150e-01,  1.320968717337e-01,  5.128548741341e-01,  1.740026175976e-01,
        -4.268943369389e-01, -3.043128550053e-01,  9.724504500628e-02, -5.009087175131e-02,  3.363549709320e-02, -3.735839575529e-02,
        -6.568700671196e-01, -1.671673730016e-02,  1.513065546751e-01,  2.196469306946e-01,  3.984552621841e-02,  2.598647177219e-01,
         5.354612469673e-01, -5.156933516264e-02,  2.624105103314e-02, -1.077219564468e-02, -5.370919033885e-02,  2.087181210518e-01,
         1.154540404677e-01,  5.666986107826e-01,  2.330120056868e-01, -2.544226646423e-01,  1.716937571764e-01, -2.390958666801e-01,
         1.276432722807e-01,  3.275994658470e-01, -3.368090465665e-02, -7.797703891993e-02, -3.267633020878e-01,  2.962595224380e-01,
         1.878380030394e-02,  4.275145232677e-01,  3.665031492710e-01,  1.359345763922e-01, -1.403442919254e-01, -3.864839300513e-02,
        -2.714699506760e-02,  4.573971331120e-01,  1.036041900516e-01, -1.759027093649e-01,  4.827292859554e-01, -3.662145929411e-03,
        -5.680845305324e-02, -6.271916627884e-02,  1.853158175945e-01,  1.789629459381e-01, -1.529680937529e-01,  9.467015415430e-02,
         1.981246471405e-01,  4.348300993443e-01,  9.796217083931e-02, -7.064592838287e-02,  2.965893745422e-01, -3.781028091908e-01,
         3.964646458626e-01, -3.556358218193e-01, -8.935313671827e-02,  8.913949877024e-02,
        -7.908350974321e-02, -1.475123763084e-01,  3.105351328850e-02, -3.590575605631e-02, -6.229372322559e-02,  5.957909673452e-02,
         1.110772192478e-01, -8.984452486038e-02,  1.658199429512e-01, -8.447363227606e-02,  1.908432245255e-01, -1.863078474998e-01,
        -1.703388243914e-01, -1.223421767354e-01,  8.251512050629e-02,  2.178183197975e-02, -3.412961959839e-04, -7.270805537701e-02,
         1.533255428076e-01,  1.680130809546e-01, -1.240524053574e-01, -1.021985113621e-01, -1.990395784378e-01,  3.973949328065e-02,
         5.566105246544e-02, -3.221291676164e-02, -5.337171256542e-02,  2.785198576748e-02, -1.097328886390e-01,  1.981360465288e-02,
         1.526493430138e-01,  6.697443872690e-02, -5.455033108592e-02,  6.487946212292e-02, -9.230964630842e-02,  2.043626271188e-02,
        -7.764872163534e-02,  2.512656748295e-01, -8.158622682095e-02, -1.034489348531e-01,  1.492317914963e-01, -8.141530305147e-02,
         1.599552109838e-02,  1.776330918074e-01,  8.920545130968e-02, -2.456106245518e-02,  9.087835252285e-02, -9.615990519524e-02,
        -1.079671382904e-01, -1.167135909200e-01, -1.535963565111e-01, -5.222854390740e-02, -1.430753991008e-02,  9.408231079578e-02,
         1.374785155058e-01, -1.723098307848e-01, -4.013015329838e-02,  3.521373122931e-02,  5.263854190707e-02,  1.218227893114e-01,
        -8.512013405561e-02, -1.170497611165e-01, -1.755993627012e-02,  2.808569073677e-01,
         2.305067926645e-01, -4.459187686443e-01,  8.614066988230e-02,  1.145662888885e-01,  2.254578024149e-01, -1.416517198086e-01,
        -8.053533732891e-02, -2.877587378025e-01, -1.010919883847e-01, -2.654754519463e-01,  2.867240924388e-03, -5.828894209117e-03,
        -3.484955132008e-01,  8.980493992567e-02, -1.373642869294e-02, -3.040478378534e-02, -1.129528880119e-01,  3.294008374214e-01,
         1.674520373344e-01,  5.326102674007e-02,  5.838001966476e-01,  1.172175109386e-01,  2.848549559712e-02,  1.433675587177e-01,
        -2.254223227501e-01,  2.251540869474e-01, -7.741308212280e-02, -2.955705225468e-01,  6.468847393990e-01, -4.775001108646e-01,
        -1.766223311424e-01, -7.287874072790e-02, -7.543584704399e-02, -4.404948651791e-02, -1.135361865163e-01, -1.204932928085e-01,
         5.199281871319e-02, -6.546253710985e-02,  4.087538719177e-01,  1.104560494423e-01, -1.049033775926e-01,  1.675137504935e-02,
         2.753915265203e-02,  8.094555698335e-03, -9.007091820240e-02, -1.773197650909e-01,  2.339591085911e-01, -1.231390461326e-01,
        -8.258089423180e-02, -8.495827019215e-02,  3.637629747391e-01,  1.338799595833e-01, -3.807707726955e-01, -9.425664320588e-03,
         6.042874604464e-02,  5.402474999428e-01,  1.480280309916e-01, -5.805811379105e-03,  6.174263358116e-01, -9.151639342308e-01,
         2.916618883610e-01, -3.106103241444e-01, -2.477934509516e-01, -4.814259111881e-01,
        -1.928284615278e-01, -3.825194388628e-02,  1.072821617126e-01,  1.070267930627e-01,  3.990222699940e-03,  3.033146075904e-02,
        -1.741360723972e-01, -6.847265362740e-02, -1.374301314354e-01, -1.023653075099e-01,  3.075091540813e-02,  9.113278239965e-02,
         1.411234438419e-01,  1.016462668777e-01, -1.409326046705e-01,  2.779231779277e-02,  2.020630240440e-02,  4.316398873925e-02,
        -6.759209185839e-02,  9.342203289270e-02, -2.816596925259e-01, -9.561600536108e-02,  1.804959625006e-01,  1.100674346089e-01,
         2.075572013855e-01,  2.526494860649e-01, -9.113447368145e-02,  5.217854306102e-02, -2.695975899696e-01,  1.166112422943e-01,
         7.018485665321e-02,  1.194460690022e-01,  6.332392245531e-02,  8.420041948557e-02,  5.729416757822e-02,  1.559948325157e-01,
        -3.234104439616e-02, -3.091387683526e-03, -9.031196124852e-03, -8.056521415710e-02,  1.513222903013e-01, -1.335513442755e-01,
         3.073953464627e-02,  2.064202129841e-01, -3.199602290988e-02,  1.350842267275e-01,  4.547911882401e-02, -1.980255842209e-01,
         1.086568534374e-01,  5.301621183753e-02,  2.148204855621e-02, -1.947564482689e-01,  2.570215761662e-01,  9.280269593000e-02,
        -6.512061506510e-02, -4.001950621605e-01, -5.127133056521e-02, -1.042727157474e-01, -1.128281280398e-01,  9.357560425997e-02,
        -1.534272581339e-01, -1.385635137558e-01, -8.890409767628e-02,  4.996617138386e-01,
         7.710712961853e-03, -4.399537667632e-02,  4.336082935333e-02,  1.850956827402e-01,  5.736657604575e-02,  2.492160648108e-01,
        -5.772015824914e-02, -1.056560501456e-01, -6.869604438543e-02, -2.869614064693e-01,  1.133390665054e-01,  5.778528749943e-02,
         2.445847261697e-03,  1.954739093781e-01,  7.122163474560e-02,  2.445491403341e-01,  1.013771444559e-01,  2.438576519489e-02,
         3.857225924730e-02, -6.168270111084e-02, -2.165846079588e-01,  3.852405119687e-03,  1.527136713266e-01,  1.466265320778e-01,
         2.658381164074e-01,  1.735068708658e-01, -3.526795655489e-02, -4.478118941188e-02, -2.486139982939e-01, -5.840170755982e-02,
        -5.205620080233e-02,  2.269435226917e-01, -1.766385324299e-02, -4.330154508352e-02, -3.613063693047e-02,  4.769547283649e-02,
        -6.485054641962e-02,  4.480729345232e-03, -3.431935980916e-02, -3.206663951278e-02,  6.869210302830e-02,  3.889530152082e-02,
         1.256260126829e-01,  1.500850766897e-01,  2.039103955030e-02, -7.021981477737e-02,  5.165205150843e-02, -4.453913494945e-02,
         5.783525854349e-02,  1.439500749111e-01,  4.168192297220e-02,  7.628150749952e-03,  7.624382525682e-02,  3.136457875371e-02,
         4.803699254990e-02, -9.779132902622e-02, -4.497768729925e-02,  7.487131655216e-02, -2.478764206171e-01, -4.932183399796e-02,
         1.567690819502e-01, -2.773246355355e-02, -6.781172007322e-02,  4.312548935413e-01,
         6.272535771132e-02, -1.170274540782e-01, -2.698937058449e-02, -2.668349146843e-01, -1.271322071552e-01, -1.585721820593e-01,
         1.231351420283e-01, -1.227245703340e-01,  2.137643396854e-01, -1.502141505480e-01,  7.662456016988e-03, -2.363524436951e-01,
        -2.589999735355e-01,  1.711504310369e-01,  8.877065032721e-02, -1.723737567663e-01, -6.921979784966e-02, -1.213315352798e-01,
        -2.678756117821e-01, -2.293299287558e-01,  3.411647975445e-01,  1.250390857458e-01, -2.773570269346e-02,  2.201639413834e-01,
         2.835712730885e-01, -2.539868354797e-01,  2.318917308003e-03, -8.400025218725e-02,  3.992398828268e-02, -1.499950233847e-02,
        -2.232954204082e-01, -5.142249166965e-02, -1.212496533990e-01, -5.371908098459e-02,  1.007393151522e-01, -1.931701898575e-01,
        -5.449822545052e-02,  9.599527344108e-03,  2.128092646599e-01, -2.065042033792e-02,  2.794848680496e-01,  1.476597040892e-02,
        -8.351167291403e-02, -2.612709105015e-01, -2.483148686588e-02, -1.068474128842e-01, -1.349124014378e-01, -9.419414214790e-03,
         6.972414255142e-02,  9.887691587210e-02,  2.102290242910e-01, -6.520457565784e-02,  3.187518194318e-02, -5.177315697074e-02,
         2.581414207816e-02, -1.667078286409e-01,  8.929906785488e-02, -7.844910770655e-02,  8.687051385641e-02, -2.067978307605e-02,
        -1.198474094272e-01,  5.227132141590e-02,  6.225881353021e-02, -1.871545240283e-02,
         2.495764382184e-02, -2.028701007366e-01, -8.025906980038e-02,  3.895713761449e-02,  1.599417999387e-02, -1.501344591379e-01,
        -1.116038635373e-01, -1.040332093835e-01,  6.822428107262e-02, -1.037069037557e-02,  9.160905331373e-02,  3.333976119757e-02,
        -9.840190410614e-02, -9.350197762251e-02,  1.168463751674e-01,  9.160960465670e-02,  5.752295255661e-03,  2.539039589465e-02,
        -3.688792511821e-02,  1.545918881893e-01, -2.904650196433e-02, -1.707939431071e-02,  1.663791090250e-01, -9.703053534031e-02,
         2.910608984530e-02, -5.740069225430e-02,  2.210228592157e-01, -1.049747765064e-01,  4.642033204436e-02,  7.893389463425e-02,
         5.888531729579e-02, -1.497067231685e-02,  1.907584816217e-01, -3.640692308545e-02,  9.543656557798e-02, -1.118995621800e-01,
        -9.565421380103e-03,  1.660408228636e-01,  1.983278244734e-02,  4.068018496037e-02, -1.442261636257e-01,  6.380898505449e-02,
        -5.431862920523e-02,  1.084783207625e-02,  1.538450568914e-01,  9.876915067434e-02, -7.416030764580e-02, -1.702610701323e-01,
        -5.612168461084e-02, -1.154858767986e-01, -6.901832669973e-02,  7.476378697902e-03,  1.049259230494e-01,  9.835533052683e-02,
         2.184525728226e-01, -1.021311581135e-01, -2.973194699734e-03,  1.766870021820e-01, -1.320831179619e-01,  2.340785562992e-01,
         3.325176611543e-02,  3.606549650431e-02, -8.250159025192e-02,  1.592881530523e-01,
        -1.202205568552e-01, -1.439516805112e-02,  6.188400834799e-02, -2.065728791058e-02,  7.682447880507e-02,  2.692518830299e-01,
         1.073812991381e-01,  1.318775303662e-02, -1.965025439858e-02,  6.126008927822e-02, -1.325895339251e-01, -1.095900610089e-01,
        -9.164568036795e-02, -1.176941543818e-01,  6.620061397552e-02,  8.476063609123e-02,  2.016898989677e-02, -2.576863579452e-02,
         1.807807087898e-01,  4.408643394709e-02, -2.662396430969e-01, -8.895047754049e-02,  4.636382311583e-02,  3.505068272352e-02,
         1.223730817437e-01, -8.063862472773e-02, -1.087622269988e-01,  1.079149320722e-01, -5.969846621156e-02, -1.080217733979e-01,
         2.223333269358e-01, -1.760886013508e-01,  6.198557466269e-02,  5.354537814856e-02,  1.137811988592e-01, -3.753431141376e-02,
        -2.380285263062e-01,  2.990269660950e-02,  7.862422615290e-02,  7.637735456228e-02,  1.729328744113e-02, -1.303785443306e-01,
         9.998859465122e-02,  5.646007880569e-02, -1.246356219053e-02,  6.634901463985e-02, -5.063115060329e-02,  1.813069880009e-01,
        -1.204832792282e-01, -1.871579140425e-02, -2.302855253220e-01, -8.114482462406e-02,  1.435030698776e-01, -8.116261661053e-02,
        -9.458890557289e-02, -1.784218549728e-01, -2.185217440128e-01, -1.074636578560e-01, -1.853630691767e-02,  7.587195187807e-02,
        -4.136705771089e-02, -1.311516463757e-01,  3.306798264384e-02,  1.600079387426e-01,
        -1.984855234623e-01, -1.184911057353e-01,  2.373302578926e-01, -2.062923014164e-01, -2.450416795909e-02, -1.131643056870e-01,
        -7.613636553288e-02, -1.385629326105e-01,  9.282112866640e-02, -7.952640950680e-02,  6.211458891630e-02,  6.221202388406e-02,
         6.970057636499e-02,  3.443175554276e-01, -5.505308508873e-02,  1.321712583303e-01,  6.385904550552e-02,  1.232819557190e-01,
        -2.475330382586e-01,  9.204469621181e-02, -6.365952491760e-01, -1.503743827343e-01,  1.300539523363e-01,  1.831304877996e-01,
         2.306298911572e-01,  4.464229568839e-02, -1.302202343941e-01,  1.280962526798e-01, -4.765683412552e-01,  3.114946186543e-02,
         1.020930334926e-01,  1.227369830012e-01, -8.509134501219e-02, -6.890481710434e-02,  1.027274504304e-01,  1.290672421455e-01,
        -9.551545977592e-02, -1.127605661750e-01, -1.282929331064e-01, -1.428486406803e-02,  1.237522959709e-01, -1.815898716450e-01,
        -1.136707421392e-02,  1.667985618114e-01, -2.291152067482e-02,  2.676799893379e-02, -1.974310912192e-02, -3.316183686256e-01,
         1.909801810980e-01,  3.422050178051e-02,  4.150331392884e-02, -1.389340460300e-01,  2.357370853424e-01, -1.974472254515e-01,
        -2.045992389321e-02, -1.751884520054e-01, -6.189967505634e-03, -6.314257159829e-03, -1.973123401403e-01,  3.125560581684e-01,
         2.654019510373e-03, -4.834312200546e-02,  7.074458152056e-02,  5.102756023407e-01,
         1.709856688976e-01, -2.031794637442e-01,  4.101804271340e-02, -2.341486960649e-01,  1.706765443087e-01,  4.260759055614e-01,
         2.499017864466e-01, -3.856216073036e-01,  9.728218615055e-02,  4.805901646614e-01,  2.318093627691e-01, -3.296568989754e-01,
        -5.206094980240e-01, -1.358960419893e-01,  1.162695810199e-01,  1.240345314145e-01, -7.960453629494e-02,  2.626757919788e-01,
         4.286473095417e-01,  2.940176725388e-01,  3.474210202694e-01,  1.497166603804e-01, -2.439602911472e-01, -1.775129288435e-01,
        -3.779508173466e-01,  2.290434241295e-01,  3.576696515083e-01, -4.244667291641e-01,  4.429087042809e-01, -1.070303469896e-01,
        -3.321323394775e-01, -3.331379964948e-02,  8.732724189758e-02, -2.038886100054e-01,  3.368612751365e-02, -1.706085652113e-01,
        -2.725564837456e-01,  3.489855527878e-01,  2.123180925846e-01,  4.393375813961e-01, -1.129251644015e-01, -8.032712340355e-02,
        -4.351737797260e-01, -2.928337454796e-01,  2.637990713120e-01,  3.053153632209e-03,  2.315231710672e-01,  5.363257527351e-01,
         1.255120187998e-01, -2.251235842705e-01,  3.771210312843e-01,  5.553003549576e-01, -4.260402321815e-01, -6.439074873924e-02,
         3.717335164547e-01,  7.210319638252e-01,  2.020307332277e-01, -9.597192704678e-02,  3.579459190369e-01, -6.208277940750e-01,
         4.290603995323e-01,  4.430124908686e-02, -1.429698169231e-01, -7.750085592270e-01,
        -1.038873009384e-02, -7.803318649530e-02, -4.672692343593e-02,  8.122976124287e-02, -5.650044977665e-02,  7.032409310341e-02,
        -5.185958370566e-02, -2.969240024686e-02,  1.217499142513e-03, -1.144736558199e-01, -1.245401217602e-03, -1.259946823120e-02,
        -1.091649010777e-02, -3.022950887680e-02,  9.854565560818e-02,  8.850461989641e-02, -8.471965789795e-02,  4.555153101683e-02,
        -9.858709573746e-02, -1.064151674509e-01,  3.073653765023e-02,  1.837059855461e-03, -5.831329524517e-02, -1.327047497034e-01,
        -5.619135126472e-02,  3.393189609051e-02, -1.157001852989e-01, -1.267960518599e-01,  1.082984730601e-02, -9.160348773003e-02,
        -1.100497841835e-01, -4.816077649593e-02, -2.012510597706e-02, -1.135881543159e-01, -8.346596360207e-02,  4.911732976325e-04,
        -1.178714632988e-01, -1.760039851069e-02, -8.414016664028e-02, -8.665466308594e-02,  4.309798404574e-02, -9.621120989323e-02,
        -9.473928809166e-02,  6.478039920330e-02,  2.337078750134e-02,  1.141116768122e-01, -3.754767030478e-02, -6.067772954702e-02,
        -1.416355278343e-02,  6.324201822281e-04,  8.548837900162e-02, -1.263127177954e-01, -1.399783045053e-02,  5.529402196407e-02,
        -6.883537769318e-02, -6.806528568268e-02,  5.748052150011e-02, -1.197731494904e-01,  2.008677646518e-02, -1.001671999693e-01,
         5.715165287256e-02, -1.060998365283e-01,  7.394322752953e-02, -1.242887750268e-01,
         1.557662338018e-01, -8.203922212124e-02,  2.829976081848e-01, -1.070533171296e-01,  2.848063409328e-01,  1.916071921587e-01,
        -3.928431272507e-01, -1.149530485272e-01, -1.107511445880e-01, -1.137700378895e-01, -9.262884408236e-02,  8.136691153049e-02,
        -2.378431558609e-01, -1.753930747509e-01,  1.965658180416e-02,  1.997084170580e-01, -5.135872960091e-02,  2.676428854465e-01,
         9.610290825367e-02,  9.652445465326e-02,  2.604145109653e-01, -8.904291689396e-02, -1.255717724562e-01,  1.042060256004e-01,
        -2.395522594452e-02,  2.692891359329e-01, -3.009070456028e-02, -1.177876740694e-01,  3.299192488194e-01, -4.024789929390e-01,
         1.555764582008e-02, -1.220704391599e-01, -7.994013279676e-02, -1.357013583183e-01, -8.848161250353e-02, -8.733795583248e-02,
         8.001283556223e-02, -1.151644736528e-01,  2.026035636663e-01,  7.337076961994e-02, -4.140923172235e-02,  1.023853719234e-01,
        -1.110913902521e-01,  2.281983345747e-01,  5.546164140105e-02, -4.445815384388e-01,  2.927528321743e-01,  9.245360642672e-02,
         2.464261502028e-01,  1.124282479286e-01,  3.706870377064e-01,  1.585933864117e-01, -3.486870527267e-01, -5.174394696951e-02,
        -9.424991160631e-02,  6.014720201492e-01,  1.750320345163e-01, -8.467544615269e-02,  1.790294349194e-01, -6.326909661293e-01,
         4.180524647236e-01, -8.380841016769e-01, -8.115616440773e-02, -5.452790260315e-01,
         1.213555932045e-01,  3.153809905052e-01, -3.698545694351e-02,  2.695249207318e-02,  1.375368237495e-01,  3.939209580421e-01,
         6.135944277048e-02, -1.492596231401e-02, -1.270061433315e-01,  4.380608797073e-01, -2.956511974335e-01, -1.687785238028e-01,
         1.180447638035e-01, -2.573122084141e-01,  9.488406032324e-02,  1.557553559542e-01, -4.927858710289e-02,  1.737306416035e-01,
         4.872013628483e-01, -1.016319617629e-01,  2.842888534069e-01,  2.612523734570e-02, -3.052040636539e-01, -2.662501633167e-01,
        -2.241586893797e-01,  1.439314484596e-01, -2.474250504747e-03, -1.934977024794e-01,  2.852819561958e-01, -1.141960769892e-01,
        -1.185611635447e-01, -2.128471881151e-01,  9.476640075445e-02, -1.377309411764e-01, -1.143239513040e-01,  2.287510186434e-01,
        -1.217486262321e-01, -2.370174676180e-01,  9.720138460398e-02,  3.160879015923e-02,  2.806467749178e-02, -1.249646469951e-01,
        -1.506354361773e-01, -2.337671071291e-02, -2.758541703224e-01,  1.481071412563e-01,  1.695341169834e-01,  2.638198733330e-01,
         9.144376218319e-02,  5.397550016642e-02,  9.547950327396e-02,  4.046483039856e-01,  1.320302933455e-01,  1.045665517449e-01,
        -1.536261737347e-01,  6.649789810181e-01,  1.500345468521e-01, -3.708491027355e-01,  1.765679419041e-01, -3.832803070545e-01,
         3.791672587395e-01, -1.872887164354e-01, -1.441930700094e-02, -1.612463295460e-01,
        -1.927374601364e-01,  2.332785427570e-01,  4.610172659159e-02, -1.395324915648e-01, -2.473979294300e-01, -3.354309499264e-02,
         4.632726684213e-02,  4.170056879520e-01, -8.512285351753e-02,  1.262772246264e-03,  8.938623219728e-02,  1.072271317244e-01,
         1.536843478680e-01,  6.109264213592e-03, -1.670171469450e-01, -3.518472909927e-01,  4.700618982315e-02, -3.754255473614e-01,
        -4.090493172407e-02, -2.554939687252e-01,  1.864218153059e-02, -3.855292871594e-02,  1.184157729149e-01, -1.338643133640e-01,
        -1.148543208838e-01, -2.663946747780e-01, -1.841358840466e-01, -1.939785666764e-02, -2.215750515461e-01,  1.075042411685e-01,
        -7.251439243555e-02,  2.498827315867e-02, -1.584689915180e-01, -1.037755087018e-01,  6.793779134750e-02, -2.613840065897e-02,
        -2.378539592028e-01, -1.779376715422e-01, -3.521319478750e-02, -1.709696277976e-02, -2.949061244726e-02, -1.060917899013e-01,
        -1.031914632767e-02, -3.669534027576e-01, -1.423496901989e-01,  2.097573131323e-02, -2.204423099756e-01,  2.274935394526e-01,
         6.403350085020e-02, -8.241790533066e-02, -2.491024285555e-01,  2.355666458607e-02, -3.010365366936e-02, -5.876686796546e-02,
        -1.175920739770e-01, -1.103167533875e-01,  8.536635339260e-02,  8.366201072931e-03, -1.800148456823e-04,  7.850502431393e-02,
        -3.139923810959e-01,  6.355409324169e-02,  9.058156609535e-02, -2.177509814501e-01,
        -9.202265739441e-02, -1.381693631411e-01,  1.320268213749e-01, -1.088502779603e-01,  5.255172029138e-03,  2.141024619341e-01,
        -1.161379292607e-01, -3.228432324249e-04,  1.785352677107e-01,  3.229106590152e-02,  6.893748790026e-02, -5.504650250077e-02,
        -2.731359899044e-01, -1.722311787307e-02,  1.450351774693e-01,  1.328719407320e-01,  6.890945136547e-02,  2.342547774315e-01,
        -1.198476031423e-01,  1.467241793871e-01, -1.471104323864e-01,  1.133284345269e-01,  1.128022447228e-01,  7.125920057297e-02,
        -1.537055615336e-02,  7.482179254293e-02,  9.939338266850e-02,  8.011074364185e-02, -4.559457004070e-01, -1.068055853248e-01,
        -6.670633796602e-03, -1.138136610389e-01, -1.036025807261e-01, -2.587090479210e-03, -3.321196511388e-02,  6.733427941799e-02,
        -3.676322102547e-02, -1.098206862807e-01, -1.022038236260e-01,  5.029377341270e-02,  1.522200405598e-01,  9.950119256973e-02,
        -7.221820950508e-02,  6.446462124586e-02, -7.989010773599e-03,  5.677695199847e-02, -3.482928127050e-02,  7.645518332720e-02,
         1.137712001801e-01,  1.627676188946e-01,  1.551056951284e-01, -3.634820505977e-02,  8.073860406876e-02, -9.813121706247e-02,
         1.856851279736e-01, -9.404601901770e-02,  5.245656706393e-03, -2.601332589984e-02, -3.292572200298e-01,  4.263253509998e-02,
         2.531073428690e-02,  7.625062018633e-02,  1.199461594224e-01,  2.884271740913e-02,
         4.823495633900e-03, -1.215569153428e-01, -2.962106093764e-02, -2.331449687481e-01,  8.503134548664e-02,  1.940083503723e-01,
         1.502942889929e-01, -5.579771846533e-02,  1.398278027773e-01, -9.712702780962e-02,  6.207320094109e-02, -1.337949335575e-01,
        -1.172219440341e-01, -8.649887889624e-02, -6.097837164998e-02, -2.018846385181e-02, -1.238452643156e-01,  1.192258577794e-02,
         1.089894324541e-01,  1.215327307582e-01, -2.040956318378e-01, -8.990871906281e-02, -1.678202003241e-01,  2.360266400501e-03,
         9.952034056187e-02, -6.785281002522e-02, -3.185341134667e-02, -3.665275871754e-02, -3.136468678713e-02, -1.427022516727e-01,
        -1.975989155471e-02,  2.082775980234e-01, -2.160043567419e-01, -4.274216666818e-02, -4.047176241875e-02, -1.235277503729e-01,
        -5.029590055346e-02,  9.838035702705e-02,  1.283834278584e-01,  8.148569613695e-03,  7.796336710453e-02, -1.250813007355e-01,
         1.208810657263e-01,  1.707756072283e-01,  2.372826337814e-01, -3.259438322857e-03,  2.090167626739e-02, -1.554068922997e-01,
        -6.966500729322e-02, -5.197772383690e-02, -4.079024121165e-02,  9.522788226604e-02, -7.776092737913e-02, -2.695894427598e-02,
         1.483267843723e-01, -2.363936305046e-01, -1.947286352515e-02, -1.361266970634e-01,  1.342448592186e-01,  7.265738397837e-02,
         6.959609687328e-02,  1.037261560559e-01, -1.266427338123e-03,  3.728258609772e-02,
         9.486837685108e-02,  1.678168773651e-01, -5.828294530511e-02, -1.289732754230e-01, -2.221750169992e-01, -7.536491006613e-02,
         1.116468608379e-01,  9.364748746157e-02,  2.028336524963e-01,  8.634743094444e-02, -4.711935296655e-03, -1.453404724598e-01,
         9.106079488993e-02,  2.406307682395e-02,  8.253689110279e-02, -1.185515448451e-01,  9.847241640091e-02, -5.269522219896e-02,
         6.501061469316e-02,  1.971132494509e-02,  1.715089082718e-01, -9.674650430679e-02, -1.096355393529e-01,  1.860479637980e-02,
        -6.748733669519e-02, -2.866483032703e-01,  1.715576201677e-01,  3.280276805162e-02,  1.113565564156e-01, -1.383039057255e-01,
        -6.933697964996e-03, -5.049696937203e-02, -1.244051530957e-01, -2.776591852307e-02, -4.949930682778e-02, -5.890398100019e-02,
        -4.363805800676e-02,  1.172089949250e-01, -8.382118493319e-02, -2.007194422185e-02, -4.106920957565e-02, -1.177029311657e-01,
        -2.668844349682e-02, -1.355856955051e-01, -7.066322863102e-02, -4.997227713466e-02, -1.083887889981e-01,  1.567641459405e-02,
         1.371905654669e-01,  1.052012890577e-01, -6.607257574797e-02, -7.496220059693e-04, -1.773735624738e-03,  9.992031008005e-02,
        -1.073465421796e-01, -5.025056749582e-02,  1.132022887468e-01, -9.755740314722e-02, -2.282666508108e-03, -7.672859728336e-02,
         1.320128608495e-02, -3.660811111331e-02,  1.256681140512e-02, -2.049905806780e-01,
        -4.123462364078e-02,  4.011478647590e-02,  5.529218912125e-02, -3.150030970573e-03,  1.191053539515e-01, -8.705440163612e-02,
         3.465445339680e-02,  1.128798946738e-01, -1.868155971169e-02,  9.097579121590e-02,  2.862462075427e-03, -9.725767374039e-02,
        -7.958990335464e-02,  3.702888637781e-02, -5.405881255865e-02,  3.006388247013e-02,  1.230319142342e-01,  4.211093112826e-02,
        -2.708985283971e-02,  3.219580277801e-02, -7.904309034348e-02, -1.050316393375e-01, -9.968224912882e-02, -1.051367521286e-01,
         2.564690820873e-02,  2.434716187418e-02, -5.233247205615e-02, -1.223123520613e-01,  5.957658216357e-02, -7.439957559109e-02,
        -2.086846530437e-02, -9.893783181906e-02, -6.945725530386e-02,  4.406781122088e-02, -1.225564032793e-01, -9.314725548029e-02,
         8.650866895914e-02, -6.186126172543e-02, -5.692071840167e-02, -3.509671986103e-02,  5.449537560344e-02, -8.199620246887e-02,
         1.974211540073e-03,  5.105033516884e-02, -1.698218844831e-02,  8.879775181413e-03, -9.548074752092e-02,  4.769175127149e-02,
         4.794593527913e-02, -1.567901670933e-02, -1.035099625587e-01,  4.999694228172e-02,  8.040605485439e-02, -2.186349034309e-02,
         5.797678232193e-02,  4.012103751302e-02, -4.956322535872e-02, -8.678634651005e-03,  1.119030490518e-01,  5.753725417890e-04,
        -9.951418638229e-02, -2.429198659956e-02,  6.220039352775e-02, -4.230370745063e-02,
         1.245805695653e-01, -2.134343832731e-01,  9.231046587229e-02, -1.296684592962e-01,  3.670650301501e-03,  4.547368735075e-02,
         1.418066024780e-01, -2.702438235283e-01,  6.121925264597e-02, -1.827681809664e-02,  2.042245566845e-01, -2.772866189480e-01,
        -4.648456573486e-01,  8.261786401272e-02,  2.487039938569e-02,  1.124219410121e-02,  6.773667037487e-02,  6.182750687003e-02,
        -1.709981858730e-01,  2.131531983614e-01,  4.275720119476e-01,  3.155570849776e-02, -1.472498327494e-01,  1.687694787979e-01,
         1.260226070881e-01,  5.539509467781e-03,  3.621019721031e-01, -3.722436353564e-02,  4.189031720161e-01, -3.388364613056e-02,
        -1.991772204638e-01,  2.214837260544e-02,  5.939281359315e-02,  7.916772365570e-02, -1.777753233910e-01, -2.695290446281e-01,
        -6.277321279049e-02,  2.050696611404e-01,  4.827420115471e-01,  2.135024666786e-01,  1.625222414732e-01, -1.154211014509e-01,
        -3.194667398930e-02, -1.602812409401e-01,  3.838773965836e-01, -3.509394079447e-02, -7.674432545900e-02,  1.888991594315e-01,
         2.514665573835e-02, -1.334384977818e-01,  2.801379263401e-01,  2.587211728096e-01, -1.953221261501e-01, -1.030542999506e-01,
         3.662733435631e-01,  1.754406690598e-01,  1.222478151321e-01, -7.073950767517e-02,  3.257968425751e-01, -2.582140564919e-01,
        -5.419980362058e-02,  9.709598869085e-02, -2.068615332246e-02, -1.518395990133e-01,
        -7.268489152193e-02,  1.520949155092e-01, -6.822713464499e-02,  9.023248404264e-02, -4.535023868084e-02,  3.296695649624e-02,
         3.283651778474e-03,  1.374063342810e-01,  2.803212776780e-02, -6.722399592400e-02,  4.871119931340e-02, -1.711816340685e-01,
         6.523504853249e-02, -1.325726360083e-01, -7.289304584265e-02, -6.822331249714e-02, -1.160106062889e-01,  1.493996679783e-01,
        -2.522868514061e-01, -1.176382079720e-01, -8.165735751390e-02, -6.641514599323e-02, -1.307208538055e-01,  1.173256710172e-02,
        -1.583825349808e-01, -1.993900686502e-01,  1.862673163414e-01,  6.818881630898e-02, -4.455059766769e-02, -8.610949665308e-02,
        -3.935516346246e-03,  4.295888170600e-02, -1.083429753780e-01,  4.505705460906e-02, -2.305398732424e-01, -2.142656594515e-01,
        -5.055529251695e-02, -1.531891077757e-01, -5.210918560624e-02, -3.522595763206e-02, -1.699950778857e-03, -9.657455235720e-02,
        -1.275432948023e-02, -9.407869726419e-02, -9.679243713617e-02, -4.451315850019e-02, -7.826643437147e-02,  1.293586790562e-01,
         4.558594897389e-02,  3.342915698886e-02,  9.658896178007e-02,  1.095629259944e-01,  1.117507275194e-02,  2.757674269378e-02,
         8.715373277664e-02, -1.290070116520e-01,  2.967723309994e-01, -1.057700216770e-01, -2.120445668697e-01, -8.705486357212e-02,
        -1.020308956504e-01,  1.520086675882e-01,  1.692205667496e-01, -2.069188505411e-01,
         7.790549844503e-02, -4.468171894550e-01,  8.451771736145e-02,  7.847504317760e-02,  2.780795991421e-01,  1.064033582807e-01,
         1.093351319432e-01, -2.124890238047e-01,  1.225641369820e-01, -1.489505767822e-01,  9.486143290997e-02, -7.784554362297e-02,
        -3.092380762100e-01,  2.014882862568e-01,  5.886551924050e-03,  1.381373852491e-01, -3.421065211296e-02,  1.002838537097e-01,
         2.467954307795e-01, -1.653465628624e-01, -2.378091365099e-01, -6.308113038540e-02,  4.902844503522e-02,  2.966726422310e-01,
         2.727588415146e-01,  2.841086089611e-01, -8.162443526089e-03, -1.652859896421e-02, -1.449254304171e-01, -1.411524601281e-02,
         5.204085260630e-02, -9.372875839472e-02, -9.359870851040e-02, -5.880075693130e-02, -7.427981495857e-02,  2.952299416065e-01,
        -1.056627631187e-01, -4.361343011260e-02,  2.518903836608e-02,  1.268495321274e-01,  1.263876855373e-01, -6.362827867270e-02,
        -2.042974680662e-01,  1.924414783716e-01, -1.422419846058e-01,  1.633420586586e-01,  2.034254521132e-01, -6.363195180893e-02,
         5.130100250244e-02, -3.918898850679e-02,  4.460327699780e-02, -4.874215275049e-02,  3.214391171932e-01,  1.744078658521e-02,
        -1.923511624336e-01,  9.941537678242e-02, -1.381272077560e-01, -8.378737419844e-02, -1.636838354170e-02,  8.384862542152e-02,
         8.782429248095e-02,  7.569545507431e-02,  3.832886368036e-02,  4.161299765110e-01,
         2.326172441244e-01,  2.306756004691e-02,  2.043612599373e-01, -4.781511798501e-02,  2.606797814369e-01,  1.316033899784e-01,
        -6.857375055552e-02, -3.795134425163e-01,  8.831062167883e-02,  1.820188611746e-01, -1.398867815733e-01, -4.825508967042e-02,
        -3.698609471321e-01, -3.389571607113e-02, -6.679415702820e-02, -2.835519844666e-03, -5.928164720535e-02,  2.298135459423e-01,
         1.164469793439e-01,  7.893577218056e-02,  7.128691077232e-01,  8.839619159698e-02, -1.602912098169e-01, -8.549702912569e-02,
        -9.330113232136e-02,  1.816830486059e-01,  6.389151513577e-02, -5.331346988678e-01,  4.990437328815e-01, -2.918163537979e-01,
        -2.318914234638e-01, -5.595295876265e-02, -1.337110698223e-01, -2.343519479036e-01, -1.175407413393e-02, -5.137093365192e-02,
        -1.920359134674e-01,  4.849928617477e-02, -8.392536081374e-03, -1.247119307518e-01, -1.942698657513e-01, -1.651228591800e-02,
        -3.539325892925e-01, -2.759926915169e-01,  2.038273587823e-02, -1.037936955690e-01,  1.938589215279e-01,  2.709232270718e-01,
         1.445238590240e-01, -5.033105984330e-02,  1.792261749506e-01,  3.328185081482e-01, -3.367774188519e-01, -1.002728790045e-01,
         1.463417150080e-02,  4.986923038960e-01,  3.088474273682e-01, -5.993091687560e-02,  3.532632291317e-01, -8.423445224762e-01,
         3.470260500908e-01, -5.393918752670e-01, -1.120978742838e-01, -4.904309511185e-01,
        -2.109142579138e-02,  3.221685588360e-01, -4.554357007146e-02, -1.376465409994e-01, -2.267118394375e-01,  2.059632092714e-01,
         1.179957538843e-01,  2.887707948685e-01, -6.364815682173e-02,  8.384496718645e-02, -4.245847836137e-02, -3.795086592436e-02,
         2.714512646198e-01, -2.145981788635e-01,  1.055188775063e-01, -1.459244787693e-01, -4.100918769836e-02,  1.154363155365e-02,
         3.983581438661e-02, -1.054688394070e-01,  4.606089890003e-01, -1.033149361610e-01, -4.755903780460e-02, -4.248110055923e-01,
        -2.706077098846e-01, -4.029767513275e-01, -9.827104210854e-02, -1.534272283316e-01,  2.674819827080e-01, -2.518372051418e-02,
        -2.056113332510e-01, -6.854382902384e-02, -2.386322468519e-01, -7.440937310457e-02,  1.692169718444e-02, -1.541701704264e-01,
         2.001636624336e-01, -1.241067126393e-01, -9.618176519871e-02, -7.153792679310e-02, -1.130906790495e-01, -7.430020719767e-03,
         7.896760106087e-02, -2.346647977829e-01, -7.229331880808e-02, -7.879868149757e-02, -2.116451114416e-01,  3.590639233589e-01,
         4.137627407908e-02, -3.703284636140e-02, -6.228824332356e-02,  3.241530954838e-01, -3.845411241055e-01,  7.644145935774e-02,
        -5.785652995110e-02,  7.619356364012e-02,  3.092358410358e-01, -1.765634268522e-01,  2.246122658253e-01, -4.338470473886e-02,
         5.293108057231e-03,  2.103432454169e-02,  3.698518872261e-02, -3.915569186211e-01,
        -7.276098430157e-02, -2.458032220602e-01,  1.365926489234e-02,  3.412323892117e-01,  8.506421744823e-02,  2.494008839130e-01,
        -3.832950070500e-02, -1.672762185335e-01,  9.847678244114e-02, -4.228981211782e-02, -2.410261146724e-02, -3.197951242328e-02,
        -9.442161023617e-02,  8.352207392454e-02,  1.632840335369e-01,  1.407060176134e-01,  5.269020795822e-02,  8.248765766621e-02,
         1.382584720850e-01,  5.652355775237e-02, -3.492395579815e-01,  9.926252067089e-03,  2.676875516772e-02,  1.095531508327e-02,
         4.536285996437e-02,  2.479567229748e-01,  1.461142301559e-01,  4.746045917273e-02, -6.975104659796e-02, -6.323433667421e-02,
         1.212911680341e-01,  1.455694288015e-01,  2.403642088175e-01,  3.373480169103e-03, -9.649272076786e-03,  1.229336336255e-01,
         1.951828002930e-01,  1.086430251598e-01, -1.998443454504e-01,  1.648531556129e-01,  2.068041265011e-02, -8.524163626134e-03,
        -4.054548591375e-02,  3.192574977875e-01,  8.120749890804e-02,  3.560740500689e-02,  3.734274953604e-02, -6.961140036583e-02,
        -1.141266599298e-01, -5.936744809151e-02, -2.048574537039e-01, -4.318476840854e-02,  1.870034784079e-01, -6.682474166155e-02,
         2.256789058447e-01, -3.100181370974e-02, -1.133691966534e-01,  1.244413182139e-01, -2.459051162004e-01,  4.079874232411e-02,
         1.411769166589e-02, -9.187867492437e-02, -7.311093155295e-03,  1.806093305349e-01,
         2.780591547489e-01, -7.267391681671e-02,  7.209009677172e-02, -1.169113069773e-01,  1.043614298105e-01,  2.390962243080e-01,
        -1.001384258270e-01, -9.761589020491e-02,  3.091500513256e-02,  4.524262621999e-02, -2.312176078558e-01,  1.658758334816e-02,
        -2.147925943136e-01, -1.645930111408e-02, -5.892490968108e-02,  1.155804395676e-01,  6.933714449406e-02,  2.053513526917e-01,
         1.931421756744e-01,  6.690333038568e-02,  2.332333475351e-01, -5.077438801527e-02, -1.402710676193e-01,  2.116765230894e-01,
         6.579570472240e-02,  3.058668971062e-01, -1.137829646468e-01,  1.447831094265e-01,  1.557485759258e-01,  2.219689637423e-02,
         1.132044345140e-01, -5.813411250710e-02, -2.703456766903e-02,  9.491264820099e-02, -1.501841396093e-01,  6.070230156183e-02,
        -1.850150674582e-01, -1.591825038195e-01,  2.174333930016e-01, -6.421031802893e-02,  3.818723931909e-02,  6.044122274034e-04,
         5.285705253482e-02,  2.496582083404e-02, -4.909385368228e-02,  9.354024380445e-02,  7.898258417845e-02,  1.944929212332e-01,
         9.015890955925e-02, -2.342461422086e-02,  6.415986269712e-02,  1.476311981678e-01,  1.802869886160e-01, -6.896006315947e-02,
         8.733168989420e-02,  2.871990203857e-01,  7.663676049560e-03, -1.058577671647e-01,  3.294731676579e-01,  2.396740391850e-02,
         2.446502149105e-01, -1.272468119860e-01,  1.335869878531e-01,  5.685533210635e-02,
        -6.532537937164e-02, -3.609822690487e-02, -8.090299367905e-02,  5.374610424042e-02,  1.187372207642e-02, -4.276679456234e-02,
        -1.269029080868e-02, -2.478480339050e-03,  1.071788221598e-01,  1.115832924843e-01, -9.623099863529e-02,  4.581210017204e-02,
         4.826845228672e-02,  4.779595136642e-02, -1.704144477844e-02,  3.126101195812e-02,  3.145456314087e-02,  1.216623485088e-01,
        -1.198034733534e-01, -4.743446409702e-02, -8.410024642944e-02, -6.063377857208e-02,  2.454227209091e-02,  7.623545825481e-02,
        -9.452675282955e-02,  8.130148053169e-02,  1.044127643108e-01, -6.161338090897e-02,  2.181732654572e-02, -6.417219340801e-02,
         2.677333354950e-02, -5.795285105705e-02, -4.869435727596e-02, -8.367706835270e-02, -1.042375117540e-01,  9.975178539753e-02,
        -1.578545570374e-02, -3.467768430710e-03, -6.220869719982e-02,  8.712537586689e-02, -7.154667377472e-02, -5.055776238441e-02,
        -9.757682681084e-02, -1.051100641489e-01,  1.109741777182e-01, -9.652446210384e-02, -1.725730299950e-02, -3.618252277374e-02,
         4.578596353531e-02,  3.343363106251e-02, -9.582386910915e-02,  1.122592985630e-01, -1.245165467262e-01,  1.236324012280e-02,
        -1.044298708439e-02, -2.896757423878e-02,  8.518335223198e-02,  1.055395901203e-01,  1.628293097019e-02, -4.414987564087e-02,
         9.293119609356e-02,  7.853370904922e-02,  2.245101332664e-02, -3.418892621994e-02,
        -1.426994614303e-02,  5.381057970226e-03,  4.944579675794e-02, -1.811098903418e-01, -1.473053842783e-01, -1.295170634985e-01,
         6.963568180799e-02, -3.332546725869e-02,  9.581591933966e-03,  1.670462638140e-02, -7.653300464153e-02, -1.086003407836e-01,
        -1.362965703011e-01,  3.092216886580e-02,  1.032778918743e-01,  5.451055988669e-02,  9.319445490837e-02, -2.516980469227e-01,
        -3.422709181905e-02,  1.360525959171e-03, -3.425319194794e-01,  1.982283405960e-02, -7.313781976700e-02,  1.350236125290e-02,
         8.343102037907e-02, -1.400214731693e-01,  4.852649196982e-02,  1.531226933002e-01, -1.773095875978e-01,  1.213570237160e-01,
        -3.077215515077e-02, -2.342658042908e-01, -2.636547386646e-01, -2.640650235116e-02,  1.045042276382e-01, -1.282099634409e-01,
        -3.286285102367e-01, -4.038862511516e-02,  6.391201168299e-02,  9.123412519693e-02,  7.078102231026e-02, -2.365113049746e-02,
        -1.622889749706e-02, -2.613799832761e-02, -9.675665758550e-03, -5.538983270526e-02, -6.521058827639e-02, -2.818709015846e-01,
         8.789540827274e-02, -2.608993090689e-03, -1.548212319613e-01, -1.432230323553e-01, -1.795327104628e-02, -1.055825203657e-01,
        -4.220116510987e-02, -9.345833957195e-02, -1.440322101116e-01,  1.086577549577e-01, -1.546507924795e-01,  1.075693145394e-01,
         5.430275946856e-02, -1.494142133743e-02,  1.416514907032e-02,  1.095445230603e-01,
        -5.972740054131e-02, -1.460069268942e-01, -6.225636228919e-03, -4.045312106609e-02,  8.321812748909e-02, -5.084913596511e-02,
        -3.817580640316e-02, -1.356913298368e-01, -1.389418840408e-01, -3.389549627900e-02,  6.197334453464e-02,  6.739825010300e-02,
         8.741738274693e-03,  1.062643453479e-01, -7.454460114241e-02,  1.160255894065e-01, -3.312887251377e-02, -1.855982840061e-01,
         8.736056834459e-02, -3.020037896931e-02, -4.005847275257e-01, -1.296486109495e-01,  6.910762190819e-02, -1.528343465179e-02,
         1.419264078140e-01,  6.691904366016e-02,  1.088482048362e-02,  1.088544577360e-01, -3.863306045532e-01,  1.162161082029e-01,
         7.418547570705e-02,  9.868848323822e-02, -7.079558074474e-02, -1.180142909288e-01, -1.633122563362e-02,  1.554178148508e-01,
        -2.937966398895e-02, -8.819310367107e-02, -8.539292030036e-03,  5.750053748488e-02,  4.056997224689e-02, -1.143132597208e-01,
        -5.886577069759e-02,  1.539871394634e-01,  9.389342367649e-02, -4.155618604273e-03,  6.784453988075e-02, -1.887058913708e-01,
         3.087878599763e-02, -1.620851606131e-01, -1.026489064097e-01, -2.655650973320e-01,  2.668628096581e-01, -1.078517213464e-01,
        -1.305436789989e-01, -2.440453469753e-01, -1.886265575886e-01,  1.771078258753e-02, -2.700268328190e-01,  3.092989027500e-01,
         6.406398862600e-02,  1.832041144371e-02,  1.801653802395e-01,  4.088101685047e-01,
         2.276558876038e-01, -3.214821815491e-01, -7.155553996563e-02, -9.370076656342e-02,  1.477652043104e-01,  1.467976570129e-01,
         9.992274641991e-02, -5.283385515213e-01, -4.745212849230e-03,  2.120579779148e-02, -9.796354919672e-02, -3.036934137344e-02,
        -5.559532046318e-01,  5.132119357586e-02,  5.329114850610e-03,  1.451707794331e-03,  6.833583116531e-02,  8.087750524282e-02,
         2.631663978100e-01,  1.043410375714e-01,  1.059931397438e+00, -8.491127938032e-02, -1.446578949690e-01, -1.492414027452e-01,
        -1.767790466547e-01,  9.480120986700e-02,  4.486878961325e-02, -4.912412762642e-01,  8.292332887650e-01, -3.601521849632e-01,
        -2.652998268604e-01,  4.712262749672e-02,  2.675580605865e-02, -2.619160711765e-01, -1.587490588427e-01,  4.766955506057e-03,
        -1.969406455755e-01, -6.372138857841e-02,  3.550328016281e-01,  2.292385883629e-02, -9.222984313965e-02, -1.504963915795e-02,
        -5.691314339638e-01, -2.948367297649e-01, -1.280386149883e-01, -2.238364666700e-01,  8.349737524986e-02,  3.221879303455e-01,
        -7.230117917061e-02, -1.043266430497e-02,  2.611263990402e-01,  3.851286768913e-01, -1.496623307467e-01,  1.498165354133e-02,
        -6.129569932818e-02,  5.690466165543e-01,  2.301648855209e-01,  1.983338221908e-02,  6.666143536568e-01, -1.098803639412e+00,
         2.770486176014e-01, -3.392421007156e-01, -3.223260343075e-01, -5.701454877853e-01,
        -1.152833700180e-01, -1.167072355747e-01,  7.226146757603e-02, -7.582889497280e-02,  8.481065928936e-02,  2.533651888371e-02,
         3.121093101799e-02,  9.660564363003e-02, -1.183835491538e-01,  8.497009426355e-02,  5.266876891255e-02, -7.979835569859e-02,
         2.895397879183e-02, -4.038070142269e-02, -5.111432075500e-02, -1.940715685487e-02, -5.893312394619e-02,  9.332834929228e-02,
         1.029600650072e-01, -2.444931305945e-03, -1.221585944295e-01, -8.116827346385e-03,  1.189000904560e-02,  7.011142373085e-02,
        -3.726452123374e-03,  2.626995742321e-02,  3.084308281541e-02, -7.774491608143e-02, -8.405185490847e-02, -1.209509223700e-01,
        -4.458349663764e-03,  5.252230912447e-02, -9.562406688929e-03,  1.316324472427e-01, -1.486465614289e-02, -9.171097725630e-02,
         3.537594899535e-02, -3.934371098876e-02, -1.272174715996e-02,  1.203454360366e-01, -7.077808957547e-03,  1.091927140951e-01,
         3.334660828114e-02, -5.721145123243e-02,  1.017402634025e-01, -7.317099720240e-02, -2.959600242320e-04,  2.081824280322e-02,
         5.574212968349e-02, -1.164125949144e-01, -2.539056586102e-03, -3.766641020775e-02,  7.819975167513e-02,  4.193723946810e-02,
         6.981027871370e-02,  6.583561748266e-02, -2.928739786148e-02, -8.008688688278e-03,  9.132111072540e-02, -1.017339453101e-01,
        -9.293790161610e-02,  1.612300239503e-02, -5.179859325290e-02, -1.308685168624e-03,
    ];
    #[rustfmt::skip]
    pub const L64_32_BIAS_1: [f32; 32] = [
        -0.068156354129,  0.025285825133, -0.935016572475, -0.094690538943,
        -0.589264929295,  0.136752739549,  0.224808305502,  0.556155383587,
        -0.355283945799, -0.100884333253,  0.272037208080, -0.388432204723,
         0.096537366509, -0.576529502869,  0.246411070228,  0.055913593620,
         0.167533889413,  0.028407642618,  0.009724969976, -0.121744282544,
        -0.150972247124,  0.274909913540, -0.042703833431, -0.460206985474,
        -0.093228183687, -0.060188647360, -0.024930655956, -0.122816622257,
        -0.027441928163, -0.070437587798, -0.471424549818, -0.122882470489,
    ];

    #[rustfmt::skip]
    pub const L64_32_WEIGHT_2: [f32; 32 * 3] = [
         0.234296202660,  0.364404290915, -0.093513920903,  0.404650241137,
        -0.775063514709,  0.097441926599, -0.212232917547,  0.015029699542,
         0.030065320432,  0.070073351264, -0.270354330540,  1.203207969666,
         0.002974887146,  0.888176977634,  0.433070480824, -0.363094568253,
        -0.507375180721,  0.204475775361, -0.294245749712,  0.068846993148,
         0.332707494497, -0.412667810917, -0.354729026556,  1.485198378563,
         0.135098159313, -0.273466408253, -0.119035959244, -0.101884610951,
        -0.002765455516,  0.062014374882,  1.489741086960,  0.040810536593,
         0.113034978509,  0.051669996232,  1.764431118965,  0.098563596606,
         1.817838907242, -0.238834530115,  0.049651890993,  0.200843453407,
        -0.028165780008,  0.590351104736, -0.149452149868, -0.063338659704,
        -0.131933644414,  1.373645782471,  0.034335881472,  0.237799361348,
        -0.046587895602, -0.353294193745, -0.272841155529,  0.081228308380,
         0.308610290289, -0.190156430006,  0.451341718435, -0.293831288815,
        -0.614155709743,  0.098800674081,  0.977209806442,  0.038464646786,
         0.096304938197,  0.049720250070,  0.548438608646, -0.117117352784,
         0.185107082129,  0.191577017307, -0.434488356113,  0.428528279066,
         0.119261585176,  0.285915046930, -0.079563945532, -0.715392589569,
        -0.401882261038,  0.206934645772,  0.201630339026, -0.252086341381,
         0.162460997701,  0.062719620764, -0.613026201725,  0.281407743692,
        -0.141554385424, -0.098104178905, -0.215249612927,  0.027913609520,
        -0.406462550163, -0.240615203977,  0.347511440516,  0.222790524364,
         0.154343709350,  0.430226981640, -0.192800119519,  0.046924024820,
         0.636716365814,  0.342453151941, -0.063868150115, -0.081568181515,
    ];
    pub const L64_32_BIAS_2: [f32; 3] = [0.277580738068, -0.013572353870, -0.376604408026];
}

#[cfg(test)]
mod tests {
    use crate::{
        losses::Absolute,
        models::Model,
        params::{Currents, ModelParams, ModulationParams, StemResistanceInvParams, Voltages},
    };

    use super::*;

    struct EquationModelMock;

    impl Model for EquationModelMock {
        fn new(_: ModelParams, _: Currents) -> Self {
            Self
        }

        fn params(&self) -> &ModelParams {
            &ModelParams {
                mod_params: ModulationParams(0.0, 0.0, 0.0),
                r_dry: 22.8,
                res_params: StemResistanceInvParams(0.0, 0.0),
                voltages: Voltages {
                    v_ds: 0.0,
                    v_gs: 0.0,
                },
            }
        }

        fn currents(&self) -> &Currents {
            &Currents {
                i_ds_on: -0.002_715,
                i_ds_off: -0.002_890_3,
                i_gs_on: 1.277_413_7e-6,
            }
        }
    }

    impl EquationModel for EquationModelMock {
        fn value(&self, concentration: f32) -> f32 {
            concentration
        }

        fn gradient(&self, _: f32) -> f32 {
            unimplemented!()
        }

        fn resistance(&self, _: f32) -> f32 {
            unimplemented!()
        }

        fn saturation(&self, _: f32) -> f32 {
            unimplemented!()
        }
    }

    #[test]
    fn test_neural_network_l16_equation() {
        let model = EquationModelMock;

        let algorithm = NeuralNetworkEquation::<_, Absolute, 0>::new((), model);
        let (variables, error) = algorithm.run().unwrap();

        assert!((variables.concentration - 0.015_984_175).abs() < 1e-6);
        assert!((variables.resistance - 9.810_755).abs() < 1e-3);
        assert!((variables.saturation - 0.362_846_64).abs() < 1e-6);
        assert!(error.abs() < 1e-1);
    }

    #[test]
    fn test_neural_network_l64_32_equation() {
        let model = EquationModelMock;

        let algorithm = NeuralNetworkEquation::<_, Absolute, 1>::new((), model);
        let (variables, error) = algorithm.run().unwrap();

        assert!((variables.concentration - 0.016_708_508).abs() < 1e-6);
        assert!((variables.resistance - 8.342_521).abs() < 1e-3);
        assert!((variables.saturation - 0.370_721_9).abs() < 1e-6);
        assert!(error.abs() < 1e-1);
    }
}
